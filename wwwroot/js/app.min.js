(function(){"use strict";window.app=angular.module("Unify",["ngRoute","infinite-scroll"]);window.app.config(function(n){n.when("/",{redirectTo:"/all"}).when("/:type/:id?/:filter?",{templateUrl:"js/app/articles/templates/articlesList.html",controller:"articlesController"})});window.app.controller("articlesController",function(n,t,i){t.getAllArticles=function(){n.getAllArticles(t.page).then(function(n){t.articles=t.articles.concat(n.data);t.load=!1})};t.getUnreadArticles=function(){n.getUnreadArticles(t.page).then(function(n){t.articles=t.articles.concat(n.data);t.load=!1})};t.getSavedArticles=function(){n.getSavedArticles(t.page).then(function(n){t.articles=t.articles.concat(n.data);t.load=!1})};t.getSource=function(){n.getSource(t.page,i.id,i.filter).then(function(n){t.articles=t.articles.concat(n.data);t.load=!1})};t.getTag=function(){n.getTag(t.page,i.id,i.filter).then(function(n){t.articles=t.articles.concat(n.data);t.load=!1})};t.loadArticles=function(){t.load=!0;switch(i.type){case"unread":t.getUnreadArticles();break;case"saved":t.getSavedArticles();break;case"all":t.getAllArticles();break;case"source":t.getSource();break;case"tag":t.getTag()}};t.incrementPageAndLoadArticles=function(){t.page=t.page+1;t.loadArticles()};t.$on("$routeChangeSuccess",function(){t.load=!1;t.articles=[];t.page=1;t.loadArticles()})})})(),function(){"use strict";function n(n){return{templateUrl:"js/app/navigation/templates/addSource.html",controller:t,controllerAs:"sourceController",link:function(t,i,r,u){n.bind("click",function(n){var r=i.find(n.target).length>0,f=i[0]==n.target,e=r||f;e||(u.hide(),t.$apply())})}}}function t(n,t){var i=this;i.form="addSourceForm";i.source={Name:null,Url:null,TagId:null};i.errorMessage=null;i.visible=!1;i.hide=function(){i.visible=!1;i.source={Name:null,Url:null,TagId:null};i.form.$setPristine();i.form.$setUntouched();i.errorMessage=null};i.toggleVisibility=function(){i.visible=!i.visible;i.source={Name:null,Url:null,TagId:null};i.form.$setPristine();i.form.$setUntouched();i.errorMessage=null};i.addSource=function(){n.addSource(i.source).then(function(){t.navigationController.getSources();t.navigationController.getTags();i.hide()},function(n){i.errorMessage=n.data})}}window.app.directive("addSource",n);n.$inject=["$document"];t.$inject=["navigationSvc","$scope"]}(),function(){"use strict";function n(n){return{templateUrl:"js/app/navigation/templates/editSource.html",controller:t,controllerAs:"sourceController",scope:{source:"="},link:function(t,i,r,u){function f(n){if(u.routes.selectedItemId!=null&&t.source.id==u.routes.selectedItemId&&u.routes.itemType!="tag"&&t.$parent.$parent.navigationController.edit!=!1){var f=i[0].contains(n.target),e=i[0]==n.target,o=f||e,r=angular.element("#editButton"),s=n.target==r[0],h=r[0].contains(n.target),c=s||h;o||c||(u.errorMessage=null,t.$parent.$parent.navigationController.edit=!1,t.$apply())}}n.bind("click",f);t.$on("$destroy",function(){n.unbind("click",f)})}}}function t(n,t,i,r,u){var f=this;f.errorMessage=null;f.form="editSourceForm";f.oldSource=n.source;f.newSource=angular.copy(n.source);n.$on("$routeChangeSuccess",function(){f.routes={itemType:r.type,itemFilter:r.filter,selectedItemId:r.id}});f.editSource=function(){t.editSource(f.newSource).then(function(){n.$parent.$parent.navigationController.getSources();n.$parent.$parent.navigationController.getTags();f.errorMessage=null;n.$parent.$parent.navigationController.edit=!1;f.redirect()},function(n){f.errorMessage=n.data})};f.redirect=function(){u.reload();i.path("/"+f.routes.itemType+"/"+f.routes.selectedItemId+"/all");i.replace()}}window.app.directive("editSource",n);n.$inject=["$document"];t.$inject=["$scope","navigationSvc","$location","$routeParams","$route"]}(),function(){"use strict";function t(){return{templateUrl:"js/app/navigation/templates/navigation.html",controller:n,controllerAs:"navigationController"}}function n(n,t,i,r,u,f){var e=this;i.$on("$routeChangeSuccess",function(){e.routes={itemType:t.type,itemFilter:t.filter,selectedItemId:t.id}});e.edit=!1;e.getSources=function(){n.getSources().then(function(n){e.sources=n.data})};e.getTags=function(){n.getTags().then(function(n){e.tags=n.data})};e.getSources();e.getTags();e.showAllSources=!1;e.showAllTags=!1;e.deleteItem=function(){e.routes.itemType=="source"&&n.deleteSource(e.routes.selectedItemId).then(function(){e.getSources();e.getTags();r.path("/all");r.replace()})};e.markAsRead=function(){(e.routes.itemType=="all"||e.routes.itemType=="unread"||e.routes.itemType=="saved")&&u.markAllAsRead().then(function(){f.reload();r.path("/"+e.routes.itemType);r.replace()});e.routes.itemType=="source"&&u.markSourceAsRead(e.routes.selectedItemId).then(function(){f.reload();r.path("/"+e.routes.itemType+"/"+e.routes.selectedItemId+"/"+e.routes.itemFilter);r.replace()});e.routes.itemType=="tag"&&u.markTagAsRead(e.routes.selectedItemId).then(function(){f.reload();r.path("/"+e.routes.itemType+"/"+e.routes.selectedItemId+"/"+e.routes.itemFilter);r.replace()})}}window.app.directive("navigation",t);n.$inject=["navigationSvc","$routeParams","$scope","$location","articlesSvc","$route"]}(),function(){function n(n){function t(){return n.get("/Source/GetAll")}function i(t){return n.post("Source/Create",t)}function r(){return n.get("/Tag/GetAll")}function u(t){return n.post("Source/Delete",t)}function f(t){return n.post("Source/Edit",t)}return{getTags:r,getSources:t,addSource:i,deleteSource:u,editSource:f}}window.app.factory("navigationSvc",n);n.$inject=["$http"]}(),function(){"use strict";function n(){return{templateUrl:"js/app/navigation/templates/sourcesList.html"}}window.app.directive("sourcesList",n)}(),function(){"use strict";function n(){return{templateUrl:"js/app/navigation/templates/tagsList.html"}}window.app.directive("tagsList",n)}(),function(){function n(n){function t(t){return n.get("/Article/GetAll",{params:{page:t}})}function i(t){return n.get("/Article/GetUnread",{params:{page:t}})}function r(t){return n.get("/Article/GetSaved",{params:{page:t}})}function u(t,i,r){return n.get("/Article/GetSource",{params:{page:t,id:i,filter:r}})}function f(t,i,r){return n.get("/Article/GetTag",{params:{page:t,id:i,filter:r}})}function e(){return n.post("/Article/MarkAllAsRead")}function o(t){return n.post("/Article/MarkSourceAsRead",t)}function s(t){return n.post("/Article/MarkTagAsRead",t)}function h(t){return n.post("/Article/MarkArticleAsRead",t)}return{getAllArticles:t,getUnreadArticles:i,getSavedArticles:r,getSource:u,getTag:f,markAllAsRead:e,markSourceAsRead:o,markTagAsRead:s,markArticleAsRead:h}}window.app.factory("articlesSvc",n);n.$inject=["$http"]}();